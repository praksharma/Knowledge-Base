
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Ridge detection &#8212; My Jupyter Book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Theory/3. MHD modes/5. Ridge detection';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Contour Detection from STFT" href="6.%20Contour%20detection.html" />
    <link rel="prev" title="Thresholding" href="4.%20Thresholding.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/kb_logo.png" class="logo__image only-light" alt=""/>
    <img src="../../_static/kb_logo.png" class="logo__image only-dark pst-js-only" alt=""/>
  
  
    <p class="title logo__title">Knowledge Base</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../0.%20Common/intro.html">
    Common
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../1.%20Disruption/intro.html">
    Disruption
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../2.%20ELMs/intro.html">
    ELMs
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="intro.html">
    MHD Modes
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../Libraries/Python/intro.html">
    Python Libraries
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../ML_models/intro.html">
    ML Models
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button"
                data-bs-toggle="dropdown" aria-expanded="false"
                aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-external" href="https://github.com/praksharma">
    GitHub Profile
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/praksharma/Knowledge-Base" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../0.%20Common/intro.html">
    Common
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../1.%20Disruption/intro.html">
    Disruption
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../2.%20ELMs/intro.html">
    ELMs
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="intro.html">
    MHD Modes
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../Libraries/Python/intro.html">
    Python Libraries
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../ML_models/intro.html">
    ML Models
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://github.com/praksharma">
    GitHub Profile
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/praksharma/Knowledge-Base" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1.%20MHD.html">Magnetohydrodynamic (MHD) modes</a></li>

<li class="toctree-l1"><a class="reference internal" href="2.%20Paper1.html">Paper 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="3.%20Mirnov_coil.html">Mirnov coils</a></li>
<li class="toctree-l1"><a class="reference internal" href="4.%20Thresholding.html">Thresholding</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Ridge detection</a></li>

<li class="toctree-l1"><a class="reference internal" href="6.%20Contour%20detection.html">Contour Detection from STFT</a></li>
<li class="toctree-l1"><a class="reference internal" href="7.%20Denoising.html">Denoising</a></li>

<li class="toctree-l1"><a class="reference internal" href="8.%20MHD%20denoising.html">Percentage based thresholding</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../intro.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="intro.html" class="nav-link">MHD Modes</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Ridge detection</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="ridge-detection">
<h1>Ridge detection<a class="headerlink" href="#ridge-detection" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">zarr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">zarr.storage</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">fsspec</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.colors</span><span class="w"> </span><span class="kn">import</span> <span class="n">LogNorm</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.signal</span><span class="w"> </span><span class="kn">import</span> <span class="n">stft</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.ndimage</span><span class="w"> </span><span class="kn">import</span> <span class="n">uniform_filter1d</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># List of shot IDs</span>
<span class="n">shot_ids</span> <span class="o">=</span> <span class="p">[</span><span class="mi">23447</span><span class="p">,</span> <span class="mi">30005</span><span class="p">,</span> <span class="mi">30021</span><span class="p">,</span> <span class="mi">30421</span><span class="p">]</span>  <span class="c1"># Add more as needed</span>

<span class="c1"># S3 endpoint</span>
<span class="n">endpoint</span> <span class="o">=</span> <span class="s2">&quot;https://s3.echo.stfc.ac.uk&quot;</span>
<span class="n">fs</span> <span class="o">=</span> <span class="n">fsspec</span><span class="o">.</span><span class="n">filesystem</span><span class="p">(</span>
    <span class="n">protocol</span><span class="o">=</span><span class="s1">&#39;simplecache&#39;</span><span class="p">,</span>
    <span class="n">target_protocol</span><span class="o">=</span><span class="s2">&quot;s3&quot;</span><span class="p">,</span>
    <span class="n">target_options</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">anon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">endpoint_url</span><span class="o">=</span><span class="n">endpoint</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">store_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">zgroup_list</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Loop through each shot ID</span>
<span class="k">for</span> <span class="n">shot_id</span> <span class="ow">in</span> <span class="n">shot_ids</span><span class="p">:</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;s3://mast/level2/shots/</span><span class="si">{</span><span class="n">shot_id</span><span class="si">}</span><span class="s2">.zarr&quot;</span>
    
    <span class="n">store</span> <span class="o">=</span> <span class="n">zarr</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">FSStore</span><span class="p">(</span><span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">)</span>
    <span class="n">store_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">store</span><span class="p">)</span>
    <span class="c1"># open or download the Zarr group</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">zgroup_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zarr</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">store</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loaded shot ID </span><span class="si">{</span><span class="n">shot_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1"># Do something with zgroup here, like listing arrays:</span>
        <span class="c1"># print(list(zgroup.array_keys()))</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to load shot ID </span><span class="si">{</span><span class="n">shot_id</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Loaded shot ID 23447
Loaded shot ID 30005
Loaded shot ID 30021
Loaded shot ID 30421
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># for store in zgroup:</span>
<span class="c1">#     root = zarr.open_group(store, mode=&#39;r&#39;)</span>
<span class="n">mirnov</span> <span class="o">=</span> <span class="p">[</span><span class="n">xr</span><span class="o">.</span><span class="n">open_zarr</span><span class="p">(</span><span class="n">store</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="s2">&quot;magnetics&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">store</span> <span class="ow">in</span> <span class="n">store_list</span><span class="p">]</span>
<span class="n">mirnov</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1f1f1f;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "►";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "▼";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 32MB
Dimensions:                                   (b_field_pol_probe_cc_channel: 5,
                                               time_mirnov: 261200,
                                               b_field_pol_probe_ccbv_channel: 40,
                                               time: 2612,
                                               b_field_pol_probe_obr_channel: 18,
                                               b_field_pol_probe_obv_channel: 18,
                                               b_field_pol_probe_omv_channel: 3,
                                               b_field_tor_probe_cc_channel: 3,
                                               b_field_tor_probe_saddle_field_channel: 12,
                                               time_saddle: 26120,
                                               b_field_tor_probe_saddle_voltage_channel: 12,
                                               flux_loop_channel: 15)
Coordinates:
  * b_field_pol_probe_cc_channel              (b_field_pol_probe_cc_channel) &lt;U13 260B ...
  * b_field_pol_probe_ccbv_channel            (b_field_pol_probe_ccbv_channel) &lt;U10 2kB ...
  * b_field_pol_probe_obr_channel             (b_field_pol_probe_obr_channel) &lt;U9 648B ...
  * b_field_pol_probe_obv_channel             (b_field_pol_probe_obv_channel) &lt;U9 648B ...
  * b_field_pol_probe_omv_channel             (b_field_pol_probe_omv_channel) &lt;U11 132B ...
  * b_field_tor_probe_cc_channel              (b_field_tor_probe_cc_channel) &lt;U13 156B ...
  * b_field_tor_probe_saddle_field_channel    (b_field_tor_probe_saddle_field_channel) &lt;U11 528B ...
  * b_field_tor_probe_saddle_voltage_channel  (b_field_tor_probe_saddle_voltage_channel) &lt;U15 720B ...
  * flux_loop_channel                         (flux_loop_channel) &lt;U12 720B &#x27;...
  * time                                      (time) float64 21kB -0.099 ... ...
  * time_mirnov                               (time_mirnov) float64 2MB -0.09...
  * time_saddle                               (time_saddle) float64 209kB -0....
Data variables:
    b_field_pol_probe_cc_field                (b_field_pol_probe_cc_channel, time_mirnov) float64 10MB ...
    b_field_pol_probe_ccbv_field              (b_field_pol_probe_ccbv_channel, time) float64 836kB ...
    b_field_pol_probe_obr_field               (b_field_pol_probe_obr_channel, time) float64 376kB ...
    b_field_pol_probe_obv_field               (b_field_pol_probe_obv_channel, time) float64 376kB ...
    b_field_pol_probe_omv_voltage             (b_field_pol_probe_omv_channel, time_mirnov) float64 6MB ...
    b_field_tor_probe_cc_field                (b_field_tor_probe_cc_channel, time_mirnov) float64 6MB ...
    b_field_tor_probe_saddle_field            (b_field_tor_probe_saddle_field_channel, time_saddle) float64 3MB ...
    b_field_tor_probe_saddle_voltage          (b_field_tor_probe_saddle_voltage_channel, time_saddle) float64 3MB ...
    flux_loop_flux                            (flux_loop_channel, time) float64 313kB ...
    ip                                        (time) float64 21kB ...
Attributes:
    description:  
    imas:         magnetics
    label:        Plasma Current
    name:         magnetics
    uda_name:     AMC_PLASMA CURRENT
    units:        A</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-220e434e-5261-4922-ac65-638ffad658d1' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-220e434e-5261-4922-ac65-638ffad658d1' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>b_field_pol_probe_cc_channel</span>: 5</li><li><span class='xr-has-index'>time_mirnov</span>: 261200</li><li><span class='xr-has-index'>b_field_pol_probe_ccbv_channel</span>: 40</li><li><span class='xr-has-index'>time</span>: 2612</li><li><span class='xr-has-index'>b_field_pol_probe_obr_channel</span>: 18</li><li><span class='xr-has-index'>b_field_pol_probe_obv_channel</span>: 18</li><li><span class='xr-has-index'>b_field_pol_probe_omv_channel</span>: 3</li><li><span class='xr-has-index'>b_field_tor_probe_cc_channel</span>: 3</li><li><span class='xr-has-index'>b_field_tor_probe_saddle_field_channel</span>: 12</li><li><span class='xr-has-index'>time_saddle</span>: 26120</li><li><span class='xr-has-index'>b_field_tor_probe_saddle_voltage_channel</span>: 12</li><li><span class='xr-has-index'>flux_loop_channel</span>: 15</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-052691bc-1591-46a8-9713-56cc0063d429' class='xr-section-summary-in' type='checkbox'  checked><label for='section-052691bc-1591-46a8-9713-56cc0063d429' class='xr-section-summary' >Coordinates: <span>(12)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>b_field_pol_probe_cc_channel</span></div><div class='xr-var-dims'>(b_field_pol_probe_cc_channel)</div><div class='xr-var-dtype'>&lt;U13</div><div class='xr-var-preview xr-preview'>&#x27;XMC_CC/MV/201&#x27; ... &#x27;XMC_CC/MV/240&#x27;</div><input id='attrs-ebd8b638-625d-4bc3-906f-12d959cf86c8' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ebd8b638-625d-4bc3-906f-12d959cf86c8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e26ca1e5-d310-4cbc-986d-24aee82f74ab' class='xr-var-data-in' type='checkbox'><label for='data-e26ca1e5-d310-4cbc-986d-24aee82f74ab' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;XMC_CC/MV/201&#x27;, &#x27;XMC_CC/MV/210&#x27;, &#x27;XMC_CC/MV/220&#x27;, &#x27;XMC_CC/MV/230&#x27;,
       &#x27;XMC_CC/MV/240&#x27;], dtype=&#x27;&lt;U13&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>b_field_pol_probe_ccbv_channel</span></div><div class='xr-var-dims'>(b_field_pol_probe_ccbv_channel)</div><div class='xr-var-dtype'>&lt;U10</div><div class='xr-var-preview xr-preview'>&#x27;AMB_CCBV01&#x27; ... &#x27;AMB_CCBV40&#x27;</div><input id='attrs-28f969ab-0e21-44a1-990d-c58cdee52952' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-28f969ab-0e21-44a1-990d-c58cdee52952' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-03c3351a-4899-4f20-abb1-a221d38d453d' class='xr-var-data-in' type='checkbox'><label for='data-03c3351a-4899-4f20-abb1-a221d38d453d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;AMB_CCBV01&#x27;, &#x27;AMB_CCBV02&#x27;, &#x27;AMB_CCBV03&#x27;, &#x27;AMB_CCBV04&#x27;, &#x27;AMB_CCBV05&#x27;,
       &#x27;AMB_CCBV06&#x27;, &#x27;AMB_CCBV07&#x27;, &#x27;AMB_CCBV08&#x27;, &#x27;AMB_CCBV09&#x27;, &#x27;AMB_CCBV10&#x27;,
       &#x27;AMB_CCBV11&#x27;, &#x27;AMB_CCBV12&#x27;, &#x27;AMB_CCBV13&#x27;, &#x27;AMB_CCBV14&#x27;, &#x27;AMB_CCBV15&#x27;,
       &#x27;AMB_CCBV16&#x27;, &#x27;AMB_CCBV17&#x27;, &#x27;AMB_CCBV18&#x27;, &#x27;AMB_CCBV19&#x27;, &#x27;AMB_CCBV20&#x27;,
       &#x27;AMB_CCBV21&#x27;, &#x27;AMB_CCBV22&#x27;, &#x27;AMB_CCBV23&#x27;, &#x27;AMB_CCBV24&#x27;, &#x27;AMB_CCBV25&#x27;,
       &#x27;AMB_CCBV26&#x27;, &#x27;AMB_CCBV27&#x27;, &#x27;AMB_CCBV28&#x27;, &#x27;AMB_CCBV29&#x27;, &#x27;AMB_CCBV30&#x27;,
       &#x27;AMB_CCBV31&#x27;, &#x27;AMB_CCBV32&#x27;, &#x27;AMB_CCBV33&#x27;, &#x27;AMB_CCBV34&#x27;, &#x27;AMB_CCBV35&#x27;,
       &#x27;AMB_CCBV36&#x27;, &#x27;AMB_CCBV37&#x27;, &#x27;AMB_CCBV38&#x27;, &#x27;AMB_CCBV39&#x27;, &#x27;AMB_CCBV40&#x27;],
      dtype=&#x27;&lt;U10&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>b_field_pol_probe_obr_channel</span></div><div class='xr-var-dims'>(b_field_pol_probe_obr_channel)</div><div class='xr-var-dtype'>&lt;U9</div><div class='xr-var-preview xr-preview'>&#x27;AMB_OBR01&#x27; ... &#x27;AMB_OBR18&#x27;</div><input id='attrs-6cf65c26-1a44-4cbd-bc98-3610f8f9ee3f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6cf65c26-1a44-4cbd-bc98-3610f8f9ee3f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a63e94d5-c2ad-432e-9993-23bcede4d6d6' class='xr-var-data-in' type='checkbox'><label for='data-a63e94d5-c2ad-432e-9993-23bcede4d6d6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;AMB_OBR01&#x27;, &#x27;AMB_OBR02&#x27;, &#x27;AMB_OBR03&#x27;, &#x27;AMB_OBR04&#x27;, &#x27;AMB_OBR05&#x27;,
       &#x27;AMB_OBR06&#x27;, &#x27;AMB_OBR07&#x27;, &#x27;AMB_OBR08&#x27;, &#x27;AMB_OBR09&#x27;, &#x27;AMB_OBR10&#x27;,
       &#x27;AMB_OBR11&#x27;, &#x27;AMB_OBR12&#x27;, &#x27;AMB_OBR13&#x27;, &#x27;AMB_OBR14&#x27;, &#x27;AMB_OBR15&#x27;,
       &#x27;AMB_OBR16&#x27;, &#x27;AMB_OBR17&#x27;, &#x27;AMB_OBR18&#x27;], dtype=&#x27;&lt;U9&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>b_field_pol_probe_obv_channel</span></div><div class='xr-var-dims'>(b_field_pol_probe_obv_channel)</div><div class='xr-var-dtype'>&lt;U9</div><div class='xr-var-preview xr-preview'>&#x27;AMB_OBV01&#x27; ... &#x27;AMB_OBV18&#x27;</div><input id='attrs-28e60f4b-4962-43bd-9faa-905ada1c7979' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-28e60f4b-4962-43bd-9faa-905ada1c7979' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4bdf1949-9935-4658-a716-e85b3fdf1f5f' class='xr-var-data-in' type='checkbox'><label for='data-4bdf1949-9935-4658-a716-e85b3fdf1f5f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;AMB_OBV01&#x27;, &#x27;AMB_OBV02&#x27;, &#x27;AMB_OBV03&#x27;, &#x27;AMB_OBV04&#x27;, &#x27;AMB_OBV05&#x27;,
       &#x27;AMB_OBV06&#x27;, &#x27;AMB_OBV07&#x27;, &#x27;AMB_OBV08&#x27;, &#x27;AMB_OBV09&#x27;, &#x27;AMB_OBV10&#x27;,
       &#x27;AMB_OBV11&#x27;, &#x27;AMB_OBV12&#x27;, &#x27;AMB_OBV13&#x27;, &#x27;AMB_OBV14&#x27;, &#x27;AMB_OBV15&#x27;,
       &#x27;AMB_OBV16&#x27;, &#x27;AMB_OBV17&#x27;, &#x27;AMB_OBV18&#x27;], dtype=&#x27;&lt;U9&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>b_field_pol_probe_omv_channel</span></div><div class='xr-var-dims'>(b_field_pol_probe_omv_channel)</div><div class='xr-var-dtype'>&lt;U11</div><div class='xr-var-preview xr-preview'>&#x27;XMC_OMV/110&#x27; ... &#x27;XMC_OMV/310&#x27;</div><input id='attrs-bebb3b1f-e39c-4f9b-9d7f-387ff40acccb' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-bebb3b1f-e39c-4f9b-9d7f-387ff40acccb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f57c7687-bf39-4221-a5f9-e2dfac221288' class='xr-var-data-in' type='checkbox'><label for='data-f57c7687-bf39-4221-a5f9-e2dfac221288' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;XMC_OMV/110&#x27;, &#x27;XMC_OMV/210&#x27;, &#x27;XMC_OMV/310&#x27;], dtype=&#x27;&lt;U11&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>b_field_tor_probe_cc_channel</span></div><div class='xr-var-dims'>(b_field_tor_probe_cc_channel)</div><div class='xr-var-dtype'>&lt;U13</div><div class='xr-var-preview xr-preview'>&#x27;XMC_CC/MT/201&#x27; ... &#x27;XMC_CC/MT/212&#x27;</div><input id='attrs-0f8db21f-06ce-4291-a373-4e16c9f42e3b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0f8db21f-06ce-4291-a373-4e16c9f42e3b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-29c1053d-d591-4adb-bc7c-bc6a85e86e3f' class='xr-var-data-in' type='checkbox'><label for='data-29c1053d-d591-4adb-bc7c-bc6a85e86e3f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;XMC_CC/MT/201&#x27;, &#x27;XMC_CC/MT/206&#x27;, &#x27;XMC_CC/MT/212&#x27;], dtype=&#x27;&lt;U13&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>b_field_tor_probe_saddle_field_channel</span></div><div class='xr-var-dims'>(b_field_tor_probe_saddle_field_channel)</div><div class='xr-var-dtype'>&lt;U11</div><div class='xr-var-preview xr-preview'>&#x27;ASM_SAD/M01&#x27; ... &#x27;ASM_SAD/M12&#x27;</div><input id='attrs-6a1b0ff1-fe19-432a-bb49-e764872ef848' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6a1b0ff1-fe19-432a-bb49-e764872ef848' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ee3f7a69-162e-42bb-a6e4-6820fcd15e31' class='xr-var-data-in' type='checkbox'><label for='data-ee3f7a69-162e-42bb-a6e4-6820fcd15e31' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;ASM_SAD/M01&#x27;, &#x27;ASM_SAD/M02&#x27;, &#x27;ASM_SAD/M03&#x27;, &#x27;ASM_SAD/M04&#x27;,
       &#x27;ASM_SAD/M05&#x27;, &#x27;ASM_SAD/M06&#x27;, &#x27;ASM_SAD/M07&#x27;, &#x27;ASM_SAD/M08&#x27;,
       &#x27;ASM_SAD/M09&#x27;, &#x27;ASM_SAD/M10&#x27;, &#x27;ASM_SAD/M11&#x27;, &#x27;ASM_SAD/M12&#x27;],
      dtype=&#x27;&lt;U11&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>b_field_tor_probe_saddle_voltage_channel</span></div><div class='xr-var-dims'>(b_field_tor_probe_saddle_voltage_channel)</div><div class='xr-var-dtype'>&lt;U15</div><div class='xr-var-preview xr-preview'>&#x27;XMB_SAD/OUT/M01&#x27; ... &#x27;XMB_SAD/O...</div><input id='attrs-9f368924-8d55-4ab8-9519-15156a24dd67' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9f368924-8d55-4ab8-9519-15156a24dd67' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-743e6cb4-cada-453e-9bf1-1d116a2f6289' class='xr-var-data-in' type='checkbox'><label for='data-743e6cb4-cada-453e-9bf1-1d116a2f6289' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;XMB_SAD/OUT/M01&#x27;, &#x27;XMB_SAD/OUT/M02&#x27;, &#x27;XMB_SAD/OUT/M03&#x27;,
       &#x27;XMB_SAD/OUT/M04&#x27;, &#x27;XMB_SAD/OUT/M05&#x27;, &#x27;XMB_SAD/OUT/M06&#x27;,
       &#x27;XMB_SAD/OUT/M07&#x27;, &#x27;XMB_SAD/OUT/M08&#x27;, &#x27;XMB_SAD/OUT/M09&#x27;,
       &#x27;XMB_SAD/OUT/M10&#x27;, &#x27;XMB_SAD/OUT/M11&#x27;, &#x27;XMB_SAD/OUT/M12&#x27;], dtype=&#x27;&lt;U15&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>flux_loop_channel</span></div><div class='xr-var-dims'>(flux_loop_channel)</div><div class='xr-var-dtype'>&lt;U12</div><div class='xr-var-preview xr-preview'>&#x27;AMB_FL/CC03&#x27; ... &#x27;AMB_FL/P6L/1&#x27;</div><input id='attrs-e37efb73-f52d-4cda-90e7-ea9d4ba3c98c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e37efb73-f52d-4cda-90e7-ea9d4ba3c98c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-55731f51-da36-4ddd-aab6-2916239a845f' class='xr-var-data-in' type='checkbox'><label for='data-55731f51-da36-4ddd-aab6-2916239a845f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;AMB_FL/CC03&#x27;, &#x27;AMB_FL/CC04&#x27;, &#x27;AMB_FL/CC05&#x27;, &#x27;AMB_FL/CC07&#x27;,
       &#x27;AMB_FL/CC09&#x27;, &#x27;AMB_FL/P3L/4&#x27;, &#x27;AMB_FL/P3U/1&#x27;, &#x27;AMB_FL/P3U/4&#x27;,
       &#x27;AMB_FL/P4L/1&#x27;, &#x27;AMB_FL/P4L/4&#x27;, &#x27;AMB_FL/P4U/4&#x27;, &#x27;AMB_FL/P5L/1&#x27;,
       &#x27;AMB_FL/P5L/4&#x27;, &#x27;AMB_FL/P5U/1&#x27;, &#x27;AMB_FL/P6L/1&#x27;], dtype=&#x27;&lt;U12&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-0.099 -0.0988 ... 0.423 0.4232</div><input id='attrs-edcb09c9-359b-4c29-ba5a-cf43601c9ba8' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-edcb09c9-359b-4c29-ba5a-cf43601c9ba8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d1e08b4f-77b0-4f19-b9ee-4d3b7622c636' class='xr-var-data-in' type='checkbox'><label for='data-d1e08b4f-77b0-4f19-b9ee-4d3b7622c636' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>s</dd></dl></div><div class='xr-var-data'><pre>array([-0.099 , -0.0988, -0.0986, ...,  0.4228,  0.423 ,  0.4232],
      shape=(2612,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time_mirnov</span></div><div class='xr-var-dims'>(time_mirnov)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-0.099 -0.099 ... 0.4234 0.4234</div><input id='attrs-66b6bb19-bb0a-457f-bad5-8c2145424b32' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-66b6bb19-bb0a-457f-bad5-8c2145424b32' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5626b929-da91-4247-a461-a280017a4c8f' class='xr-var-data-in' type='checkbox'><label for='data-5626b929-da91-4247-a461-a280017a4c8f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>s</dd></dl></div><div class='xr-var-data'><pre>array([-0.099   , -0.098998, -0.098996, ...,  0.423394,  0.423396,  0.423398],
      shape=(261200,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time_saddle</span></div><div class='xr-var-dims'>(time_saddle)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-0.099 -0.09898 ... 0.4234 0.4234</div><input id='attrs-70e981db-2827-4ecf-911c-7aa808264355' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-70e981db-2827-4ecf-911c-7aa808264355' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5c9576f6-e451-41d5-aa36-94d3a0a9475e' class='xr-var-data-in' type='checkbox'><label for='data-5c9576f6-e451-41d5-aa36-94d3a0a9475e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>s</dd></dl></div><div class='xr-var-data'><pre>array([-0.099  , -0.09898, -0.09896, ...,  0.42334,  0.42336,  0.42338],
      shape=(26120,))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-ee3d1fc4-9977-4c24-9f38-3a8a71aab518' class='xr-section-summary-in' type='checkbox'  checked><label for='section-ee3d1fc4-9977-4c24-9f38-3a8a71aab518' class='xr-section-summary' >Data variables: <span>(10)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>b_field_pol_probe_cc_field</span></div><div class='xr-var-dims'>(b_field_pol_probe_cc_channel, time_mirnov)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-276d4a2c-bf20-4d4e-8002-a7cb95367ce1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-276d4a2c-bf20-4d4e-8002-a7cb95367ce1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-62c37890-93f1-4fc8-bfe4-99ef07e87276' class='xr-var-data-in' type='checkbox'><label for='data-62c37890-93f1-4fc8-bfe4-99ef07e87276' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>Centre column poloidal mirnov array</dd><dt><span>imas :</span></dt><dd>magnetics.b_field_pol_probe[:].field.data</dd><dt><span>label :</span></dt><dd>Tesla/sec</dd><dt><span>name :</span></dt><dd>b_field_pol_probe_cc_field</dd><dt><span>uda_name :</span></dt><dd>XMC_CC/MV/201</dd><dt><span>units :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>[1306000 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>b_field_pol_probe_ccbv_field</span></div><div class='xr-var-dims'>(b_field_pol_probe_ccbv_channel, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-5d53f952-793c-4120-a2ea-79cb575f4e40' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5d53f952-793c-4120-a2ea-79cb575f4e40' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b970b15d-329f-4ea1-bec3-b77ef09f0aa4' class='xr-var-data-in' type='checkbox'><label for='data-b970b15d-329f-4ea1-bec3-b77ef09f0aa4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>Centre column Bv array</dd><dt><span>imas :</span></dt><dd>magnetics.b_field_pol_probe[:].field.data</dd><dt><span>label :</span></dt><dd>CCBV01</dd><dt><span>name :</span></dt><dd>b_field_pol_probe_ccbv_field</dd><dt><span>uda_name :</span></dt><dd>AMB_CCBV01</dd><dt><span>units :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>[104480 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>b_field_pol_probe_obr_field</span></div><div class='xr-var-dims'>(b_field_pol_probe_obr_channel, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-9a94969d-2186-4011-8da1-bd3a17e2be62' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9a94969d-2186-4011-8da1-bd3a17e2be62' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-17970e14-b756-4835-b086-69dec312765f' class='xr-var-data-in' type='checkbox'><label for='data-17970e14-b756-4835-b086-69dec312765f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>Outer Br array</dd><dt><span>imas :</span></dt><dd>magnetics.b_field_pol_probe[:].field.data</dd><dt><span>label :</span></dt><dd>OBR01</dd><dt><span>name :</span></dt><dd>b_field_pol_probe_obr_field</dd><dt><span>uda_name :</span></dt><dd>AMB_OBR01</dd><dt><span>units :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>[47016 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>b_field_pol_probe_obv_field</span></div><div class='xr-var-dims'>(b_field_pol_probe_obv_channel, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-64f7cbe8-73d8-4425-9a2c-f99ef677a91d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-64f7cbe8-73d8-4425-9a2c-f99ef677a91d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-83e42e38-bb61-4bbb-bf5c-e39055f63f99' class='xr-var-data-in' type='checkbox'><label for='data-83e42e38-bb61-4bbb-bf5c-e39055f63f99' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>Outer Bv array</dd><dt><span>imas :</span></dt><dd>magnetics.b_field_pol_probe[:].field.data</dd><dt><span>label :</span></dt><dd>OBV01</dd><dt><span>name :</span></dt><dd>b_field_pol_probe_obv_field</dd><dt><span>uda_name :</span></dt><dd>AMB_OBV01</dd><dt><span>units :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>[47016 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>b_field_pol_probe_omv_voltage</span></div><div class='xr-var-dims'>(b_field_pol_probe_omv_channel, time_mirnov)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-b54a2b7e-5ba0-4b9e-9f34-3681e55feefa' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b54a2b7e-5ba0-4b9e-9f34-3681e55feefa' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c242ae05-0dca-4d0a-bf79-56d5d04a4dad' class='xr-var-data-in' type='checkbox'><label for='data-c242ae05-0dca-4d0a-bf79-56d5d04a4dad' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>Outboard vertical mirnov array</dd><dt><span>imas :</span></dt><dd>magnetics.b_field_tor_probe[:].voltage.data</dd><dt><span>label :</span></dt><dd>Volt</dd><dt><span>name :</span></dt><dd>b_field_pol_probe_omv_voltage</dd><dt><span>uda_name :</span></dt><dd>XMC_OMV/110</dd><dt><span>units :</span></dt><dd>V</dd></dl></div><div class='xr-var-data'><pre>[783600 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>b_field_tor_probe_cc_field</span></div><div class='xr-var-dims'>(b_field_tor_probe_cc_channel, time_mirnov)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-85dc6400-0e0c-49ba-b48d-8c68684d8b5a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-85dc6400-0e0c-49ba-b48d-8c68684d8b5a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-76d727d1-fa51-489e-a3e1-959e07edadc4' class='xr-var-data-in' type='checkbox'><label for='data-76d727d1-fa51-489e-a3e1-959e07edadc4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>Centre column toroidal mirnov array</dd><dt><span>imas :</span></dt><dd>magnetics.b_field_tor_probe[:].field.data</dd><dt><span>label :</span></dt><dd>Tesla/sec</dd><dt><span>name :</span></dt><dd>b_field_tor_probe_cc_field</dd><dt><span>uda_name :</span></dt><dd>XMC_CC/MT/201</dd><dt><span>units :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>[783600 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>b_field_tor_probe_saddle_field</span></div><div class='xr-var-dims'>(b_field_tor_probe_saddle_field_channel, time_saddle)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-dde9466e-ba69-4194-9641-3e83a919f445' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-dde9466e-ba69-4194-9641-3e83a919f445' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cfa220c3-0191-473a-9d14-3f39b9550814' class='xr-var-data-in' type='checkbox'><label for='data-cfa220c3-0191-473a-9d14-3f39b9550814' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd></dd><dt><span>imas :</span></dt><dd>magnetics.b_field_tor_probe[:].field.data</dd><dt><span>label :</span></dt><dd>mT</dd><dt><span>name :</span></dt><dd>b_field_tor_probe_saddle_field</dd><dt><span>uda_name :</span></dt><dd>ASM_SAD/M01</dd><dt><span>units :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>[313440 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>b_field_tor_probe_saddle_voltage</span></div><div class='xr-var-dims'>(b_field_tor_probe_saddle_voltage_channel, time_saddle)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-41412656-3226-4c32-97e2-219a3781a0ea' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-41412656-3226-4c32-97e2-219a3781a0ea' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-115502c4-9a3a-43e8-8ebe-7b811359d457' class='xr-var-data-in' type='checkbox'><label for='data-115502c4-9a3a-43e8-8ebe-7b811359d457' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd></dd><dt><span>imas :</span></dt><dd>magnetics.b_field_tor_probe[:].voltage.data</dd><dt><span>label :</span></dt><dd>V</dd><dt><span>name :</span></dt><dd>b_field_tor_probe_saddle_voltage</dd><dt><span>uda_name :</span></dt><dd>XMB_SAD/OUT/M01</dd><dt><span>units :</span></dt><dd>V</dd></dl></div><div class='xr-var-data'><pre>[313440 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>flux_loop_flux</span></div><div class='xr-var-dims'>(flux_loop_channel, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-423a440a-0796-4cdb-b039-04e360b907bd' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-423a440a-0796-4cdb-b039-04e360b907bd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9fbc213e-8f06-470c-920c-c980a01f61a1' class='xr-var-data-in' type='checkbox'><label for='data-9fbc213e-8f06-470c-920c-c980a01f61a1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd></dd><dt><span>imas :</span></dt><dd>magnetics.flux_loop[:].flux.data</dd><dt><span>label :</span></dt><dd>FL/CC03</dd><dt><span>name :</span></dt><dd>flux_loop_flux</dd><dt><span>uda_name :</span></dt><dd>AMB_FL/CC03</dd><dt><span>units :</span></dt><dd>Wb</dd></dl></div><div class='xr-var-data'><pre>[39180 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ip</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-935800b7-4778-49cd-a3a6-6e4ba68f8396' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-935800b7-4778-49cd-a3a6-6e4ba68f8396' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c6ce4cd1-f595-45e6-81f9-9f206ceb7dd0' class='xr-var-data-in' type='checkbox'><label for='data-c6ce4cd1-f595-45e6-81f9-9f206ceb7dd0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd></dd><dt><span>imas :</span></dt><dd>magnetics.ip[:].data</dd><dt><span>label :</span></dt><dd>Plasma Current</dd><dt><span>name :</span></dt><dd>ip</dd><dt><span>uda_name :</span></dt><dd>AMC_PLASMA CURRENT</dd><dt><span>units :</span></dt><dd>A</dd></dl></div><div class='xr-var-data'><pre>[2612 values with dtype=float64]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-37944063-8114-416a-9c87-b1ec86045ba2' class='xr-section-summary-in' type='checkbox'  ><label for='section-37944063-8114-416a-9c87-b1ec86045ba2' class='xr-section-summary' >Indexes: <span>(12)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>b_field_pol_probe_cc_channel</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-d15a747d-6b06-4af2-ae40-a238c6b58fb3' class='xr-index-data-in' type='checkbox'/><label for='index-d15a747d-6b06-4af2-ae40-a238c6b58fb3' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;XMC_CC/MV/201&#x27;, &#x27;XMC_CC/MV/210&#x27;, &#x27;XMC_CC/MV/220&#x27;, &#x27;XMC_CC/MV/230&#x27;,
       &#x27;XMC_CC/MV/240&#x27;],
      dtype=&#x27;object&#x27;, name=&#x27;b_field_pol_probe_cc_channel&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>b_field_pol_probe_ccbv_channel</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-4b3a70e7-4e5b-44b9-a282-e0ed977d7876' class='xr-index-data-in' type='checkbox'/><label for='index-4b3a70e7-4e5b-44b9-a282-e0ed977d7876' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;AMB_CCBV01&#x27;, &#x27;AMB_CCBV02&#x27;, &#x27;AMB_CCBV03&#x27;, &#x27;AMB_CCBV04&#x27;, &#x27;AMB_CCBV05&#x27;,
       &#x27;AMB_CCBV06&#x27;, &#x27;AMB_CCBV07&#x27;, &#x27;AMB_CCBV08&#x27;, &#x27;AMB_CCBV09&#x27;, &#x27;AMB_CCBV10&#x27;,
       &#x27;AMB_CCBV11&#x27;, &#x27;AMB_CCBV12&#x27;, &#x27;AMB_CCBV13&#x27;, &#x27;AMB_CCBV14&#x27;, &#x27;AMB_CCBV15&#x27;,
       &#x27;AMB_CCBV16&#x27;, &#x27;AMB_CCBV17&#x27;, &#x27;AMB_CCBV18&#x27;, &#x27;AMB_CCBV19&#x27;, &#x27;AMB_CCBV20&#x27;,
       &#x27;AMB_CCBV21&#x27;, &#x27;AMB_CCBV22&#x27;, &#x27;AMB_CCBV23&#x27;, &#x27;AMB_CCBV24&#x27;, &#x27;AMB_CCBV25&#x27;,
       &#x27;AMB_CCBV26&#x27;, &#x27;AMB_CCBV27&#x27;, &#x27;AMB_CCBV28&#x27;, &#x27;AMB_CCBV29&#x27;, &#x27;AMB_CCBV30&#x27;,
       &#x27;AMB_CCBV31&#x27;, &#x27;AMB_CCBV32&#x27;, &#x27;AMB_CCBV33&#x27;, &#x27;AMB_CCBV34&#x27;, &#x27;AMB_CCBV35&#x27;,
       &#x27;AMB_CCBV36&#x27;, &#x27;AMB_CCBV37&#x27;, &#x27;AMB_CCBV38&#x27;, &#x27;AMB_CCBV39&#x27;, &#x27;AMB_CCBV40&#x27;],
      dtype=&#x27;object&#x27;, name=&#x27;b_field_pol_probe_ccbv_channel&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>b_field_pol_probe_obr_channel</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-336977cf-cb22-4790-abe5-569c59422a72' class='xr-index-data-in' type='checkbox'/><label for='index-336977cf-cb22-4790-abe5-569c59422a72' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;AMB_OBR01&#x27;, &#x27;AMB_OBR02&#x27;, &#x27;AMB_OBR03&#x27;, &#x27;AMB_OBR04&#x27;, &#x27;AMB_OBR05&#x27;,
       &#x27;AMB_OBR06&#x27;, &#x27;AMB_OBR07&#x27;, &#x27;AMB_OBR08&#x27;, &#x27;AMB_OBR09&#x27;, &#x27;AMB_OBR10&#x27;,
       &#x27;AMB_OBR11&#x27;, &#x27;AMB_OBR12&#x27;, &#x27;AMB_OBR13&#x27;, &#x27;AMB_OBR14&#x27;, &#x27;AMB_OBR15&#x27;,
       &#x27;AMB_OBR16&#x27;, &#x27;AMB_OBR17&#x27;, &#x27;AMB_OBR18&#x27;],
      dtype=&#x27;object&#x27;, name=&#x27;b_field_pol_probe_obr_channel&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>b_field_pol_probe_obv_channel</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-35cebee9-118f-4f0a-b1de-cc5dfd22e2db' class='xr-index-data-in' type='checkbox'/><label for='index-35cebee9-118f-4f0a-b1de-cc5dfd22e2db' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;AMB_OBV01&#x27;, &#x27;AMB_OBV02&#x27;, &#x27;AMB_OBV03&#x27;, &#x27;AMB_OBV04&#x27;, &#x27;AMB_OBV05&#x27;,
       &#x27;AMB_OBV06&#x27;, &#x27;AMB_OBV07&#x27;, &#x27;AMB_OBV08&#x27;, &#x27;AMB_OBV09&#x27;, &#x27;AMB_OBV10&#x27;,
       &#x27;AMB_OBV11&#x27;, &#x27;AMB_OBV12&#x27;, &#x27;AMB_OBV13&#x27;, &#x27;AMB_OBV14&#x27;, &#x27;AMB_OBV15&#x27;,
       &#x27;AMB_OBV16&#x27;, &#x27;AMB_OBV17&#x27;, &#x27;AMB_OBV18&#x27;],
      dtype=&#x27;object&#x27;, name=&#x27;b_field_pol_probe_obv_channel&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>b_field_pol_probe_omv_channel</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-dd02db60-44b1-49b0-8fc7-2b6fe392ce46' class='xr-index-data-in' type='checkbox'/><label for='index-dd02db60-44b1-49b0-8fc7-2b6fe392ce46' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;XMC_OMV/110&#x27;, &#x27;XMC_OMV/210&#x27;, &#x27;XMC_OMV/310&#x27;], dtype=&#x27;object&#x27;, name=&#x27;b_field_pol_probe_omv_channel&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>b_field_tor_probe_cc_channel</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-5028209b-e701-430a-814c-d440d879355e' class='xr-index-data-in' type='checkbox'/><label for='index-5028209b-e701-430a-814c-d440d879355e' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;XMC_CC/MT/201&#x27;, &#x27;XMC_CC/MT/206&#x27;, &#x27;XMC_CC/MT/212&#x27;], dtype=&#x27;object&#x27;, name=&#x27;b_field_tor_probe_cc_channel&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>b_field_tor_probe_saddle_field_channel</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-2f9e00b2-2a1d-4ce9-8f9e-58a21123068f' class='xr-index-data-in' type='checkbox'/><label for='index-2f9e00b2-2a1d-4ce9-8f9e-58a21123068f' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;ASM_SAD/M01&#x27;, &#x27;ASM_SAD/M02&#x27;, &#x27;ASM_SAD/M03&#x27;, &#x27;ASM_SAD/M04&#x27;,
       &#x27;ASM_SAD/M05&#x27;, &#x27;ASM_SAD/M06&#x27;, &#x27;ASM_SAD/M07&#x27;, &#x27;ASM_SAD/M08&#x27;,
       &#x27;ASM_SAD/M09&#x27;, &#x27;ASM_SAD/M10&#x27;, &#x27;ASM_SAD/M11&#x27;, &#x27;ASM_SAD/M12&#x27;],
      dtype=&#x27;object&#x27;, name=&#x27;b_field_tor_probe_saddle_field_channel&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>b_field_tor_probe_saddle_voltage_channel</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-b4832a6f-094d-4674-b213-1b277eca1ad1' class='xr-index-data-in' type='checkbox'/><label for='index-b4832a6f-094d-4674-b213-1b277eca1ad1' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;XMB_SAD/OUT/M01&#x27;, &#x27;XMB_SAD/OUT/M02&#x27;, &#x27;XMB_SAD/OUT/M03&#x27;,
       &#x27;XMB_SAD/OUT/M04&#x27;, &#x27;XMB_SAD/OUT/M05&#x27;, &#x27;XMB_SAD/OUT/M06&#x27;,
       &#x27;XMB_SAD/OUT/M07&#x27;, &#x27;XMB_SAD/OUT/M08&#x27;, &#x27;XMB_SAD/OUT/M09&#x27;,
       &#x27;XMB_SAD/OUT/M10&#x27;, &#x27;XMB_SAD/OUT/M11&#x27;, &#x27;XMB_SAD/OUT/M12&#x27;],
      dtype=&#x27;object&#x27;, name=&#x27;b_field_tor_probe_saddle_voltage_channel&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>flux_loop_channel</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-13228dd7-9d89-4f2b-9cd6-a9bf8248590d' class='xr-index-data-in' type='checkbox'/><label for='index-13228dd7-9d89-4f2b-9cd6-a9bf8248590d' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;AMB_FL/CC03&#x27;, &#x27;AMB_FL/CC04&#x27;, &#x27;AMB_FL/CC05&#x27;, &#x27;AMB_FL/CC07&#x27;,
       &#x27;AMB_FL/CC09&#x27;, &#x27;AMB_FL/P3L/4&#x27;, &#x27;AMB_FL/P3U/1&#x27;, &#x27;AMB_FL/P3U/4&#x27;,
       &#x27;AMB_FL/P4L/1&#x27;, &#x27;AMB_FL/P4L/4&#x27;, &#x27;AMB_FL/P4U/4&#x27;, &#x27;AMB_FL/P5L/1&#x27;,
       &#x27;AMB_FL/P5L/4&#x27;, &#x27;AMB_FL/P5U/1&#x27;, &#x27;AMB_FL/P6L/1&#x27;],
      dtype=&#x27;object&#x27;, name=&#x27;flux_loop_channel&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-5eb8496a-1d42-4d13-a7bf-ad187f70ec9b' class='xr-index-data-in' type='checkbox'/><label for='index-5eb8496a-1d42-4d13-a7bf-ad187f70ec9b' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ -0.0990000069141388, -0.09880000691413879, -0.09860000691413878,
       -0.09840000691413878, -0.09820000691413877, -0.09800000691413877,
       -0.09780000691413876, -0.09760000691413875, -0.09740000691413875,
       -0.09720000691413874,
       ...
        0.42139999308587606,  0.42159999308587615,   0.4217999930858761,
         0.4219999930858761,   0.4221999930858762,  0.42239999308587617,
        0.42259999308587615,   0.4227999930858761,   0.4229999930858761,
         0.4231999930858762],
      dtype=&#x27;float64&#x27;, name=&#x27;time&#x27;, length=2612))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time_mirnov</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-5ebc336c-46fd-4e5b-951c-f609c943d294' class='xr-index-data-in' type='checkbox'/><label for='index-5ebc336c-46fd-4e5b-951c-f609c943d294' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ -0.0990000069141388, -0.09899800691413879, -0.09899600691413879,
       -0.09899400691413879, -0.09899200691413879, -0.09899000691413878,
       -0.09898800691413878, -0.09898600691413878, -0.09898400691413878,
       -0.09898200691413878,
       ...
        0.42337999308638363,   0.4233819930863836,  0.42338399308638364,
         0.4233859930863837,  0.42338799308638364,   0.4233899930863836,
        0.42339199308638364,   0.4233939930863837,  0.42339599308638365,
         0.4233979930863836],
      dtype=&#x27;float64&#x27;, name=&#x27;time_mirnov&#x27;, length=261200))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time_saddle</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-3920e853-33ca-4a6e-8e2a-3cb73208a34f' class='xr-index-data-in' type='checkbox'/><label for='index-3920e853-33ca-4a6e-8e2a-3cb73208a34f' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ -0.0990000069141388, -0.09898000691413879, -0.09896000691413878,
       -0.09894000691413878, -0.09892000691413877, -0.09890000691413876,
       -0.09888000691413876, -0.09886000691413875, -0.09884000691413874,
       -0.09882000691413874,
       ...
         0.4231999930860211,   0.4232199930860211,   0.4232399930860211,
        0.42325999308602114,  0.42327999308602116,   0.4232999930860212,
         0.4233199930860212,   0.4233399930860211,   0.4233599930860211,
        0.42337999308602114],
      dtype=&#x27;float64&#x27;, name=&#x27;time_saddle&#x27;, length=26120))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-6b4cb8c3-c6bb-4104-baa4-0b3588150574' class='xr-section-summary-in' type='checkbox'  checked><label for='section-6b4cb8c3-c6bb-4104-baa4-0b3588150574' class='xr-section-summary' >Attributes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>description :</span></dt><dd></dd><dt><span>imas :</span></dt><dd>magnetics</dd><dt><span>label :</span></dt><dd>Plasma Current</dd><dt><span>name :</span></dt><dd>magnetics</dd><dt><span>uda_name :</span></dt><dd>AMC_PLASMA CURRENT</dd><dt><span>units :</span></dt><dd>A</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract the DataArrays</span>
<span class="n">ds_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span><span class="p">[</span><span class="s1">&#39;b_field_pol_probe_omv_voltage&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">b_field_pol_probe_omv_channel</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">mirnov</span><span class="p">]</span>

<span class="c1"># Plot all in one figure</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ds</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ds_list</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">ds</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Shot </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/8fb1e60b4232a66621a4da5771456af08b0cff13735ac3c64081a39b291c3b9b.png" src="../../_images/8fb1e60b4232a66621a4da5771456af08b0cff13735ac3c64081a39b291c3b9b.png" />
<img alt="../../_images/c8af5f987476b86614594f1f669b77bf75a27553c30ef1dd73f3d24eb4d919ad.png" src="../../_images/c8af5f987476b86614594f1f669b77bf75a27553c30ef1dd73f3d24eb4d919ad.png" />
<img alt="../../_images/1fbfa89779911d8c6396a0fb1669ced0f60b321cca67af666cc58483fa3cff48.png" src="../../_images/1fbfa89779911d8c6396a0fb1669ced0f60b321cca67af666cc58483fa3cff48.png" />
<img alt="../../_images/6a9b1fbf7ed2557ab258c9aabbfd730c7179deab62f6d1fec600a7a4f62d6cd6.png" src="../../_images/6a9b1fbf7ed2557ab258c9aabbfd730c7179deab62f6d1fec600a7a4f62d6cd6.png" />
</div>
</div>
<section id="short-time-fourier-transform-stft">
<h2>Short-Time Fourier Transform (STFT)<a class="headerlink" href="#short-time-fourier-transform-stft" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_stft_spectrogram</span><span class="p">(</span>    <span class="n">ds</span><span class="p">,</span>    <span class="n">shot_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>    <span class="n">nperseg</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span>    <span class="n">nfft</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span>    <span class="n">tmin</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>    <span class="n">tmax</span><span class="o">=</span><span class="mf">0.46</span><span class="p">,</span>    <span class="n">fmax_kHz</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>    <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot STFT spectrogram for a given xarray DataArray `ds`.</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    - ds: xarray.DataArray with a &#39;time_mirnov&#39; coordinate.</span>
<span class="sd">    - shot_id: Optional shot ID for labeling.</span>
<span class="sd">    - nperseg: Number of points per STFT segment.</span>
<span class="sd">    - nfft: Number of FFT points.</span>
<span class="sd">    - tmin, tmax: Time range to display (seconds).</span>
<span class="sd">    - fmax_kHz: Max frequency to display (kHz).</span>
<span class="sd">    - cmap: Colormap name.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sample_rate</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">time_mirnov</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ds</span><span class="o">.</span><span class="n">time_mirnov</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">f</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Zxx</span> <span class="o">=</span> <span class="n">stft</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">sample_rate</span><span class="p">),</span> <span class="n">nperseg</span><span class="o">=</span><span class="n">nperseg</span><span class="p">,</span> <span class="n">nfft</span><span class="o">=</span><span class="n">nfft</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="n">cax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span>
        <span class="n">t</span><span class="p">,</span> <span class="n">f</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Zxx</span><span class="p">),</span>
        <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span>
        <span class="n">norm</span><span class="o">=</span><span class="n">LogNorm</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fmax_kHz</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency [kHz]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time [sec]&#39;</span><span class="p">)</span>
    <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;STFT Spectrogram&quot;</span>
    <span class="k">if</span> <span class="n">shot_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">title</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; - Shot </span><span class="si">{</span><span class="n">shot_id</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cax</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">plot_stft_spectrogram</span><span class="p">(</span><span class="n">ds_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">shot_ids</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ds_list</span><span class="p">))]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[None, None, None, None]
</pre></div>
</div>
<img alt="../../_images/c17b52e0d173da12c6d17afee38b4e094cde8d4da00557feb6fbaf291ea802cb.png" src="../../_images/c17b52e0d173da12c6d17afee38b4e094cde8d4da00557feb6fbaf291ea802cb.png" />
<img alt="../../_images/ed762b82c3fa9f2d731807eee6d583e86e93019ec85f8f8ad8a2a6d567c7c262.png" src="../../_images/ed762b82c3fa9f2d731807eee6d583e86e93019ec85f8f8ad8a2a6d567c7c262.png" />
<img alt="../../_images/30cc300e3f10893e6de096d329a639846fc5174aab723321a9627c2fe135d9f8.png" src="../../_images/30cc300e3f10893e6de096d329a639846fc5174aab723321a9627c2fe135d9f8.png" />
<img alt="../../_images/5100becfcaefdc610237cdadd64ae136681f621bc0aa8365709b13a94614f44b.png" src="../../_images/5100becfcaefdc610237cdadd64ae136681f621bc0aa8365709b13a94614f44b.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_stft_histogram</span><span class="p">(</span>    <span class="n">ds</span><span class="p">,</span>    <span class="n">shot_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>    <span class="n">nperseg</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span>    <span class="n">nfft</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span>    <span class="n">bins</span><span class="o">=</span><span class="mi">100</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot a histogram of the absolute STFT amplitude values.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - ds: xarray.DataArray with a &#39;time_mirnov&#39; coordinate.</span>
<span class="sd">    - shot_id: Optional shot ID for labeling.</span>
<span class="sd">    - nperseg: Number of points per STFT segment.</span>
<span class="sd">    - nfft: Number of FFT points.</span>
<span class="sd">    - bins: Number of histogram bins.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sample_rate</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">time_mirnov</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ds</span><span class="o">.</span><span class="n">time_mirnov</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">f</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Zxx</span> <span class="o">=</span> <span class="n">stft</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">sample_rate</span><span class="p">),</span> <span class="n">nperseg</span><span class="o">=</span><span class="n">nperseg</span><span class="p">,</span> <span class="n">nfft</span><span class="o">=</span><span class="n">nfft</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Zxx</span><span class="o">.</span><span class="n">flatten</span><span class="p">()),</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Count (log scale)&#39;</span><span class="p">)</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Histogram of Spectrogram Amplitudes&#39;</span>
    <span class="k">if</span> <span class="n">shot_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">title</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; - Shot </span><span class="si">{</span><span class="n">shot_id</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">f</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Zxx</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f_list</span><span class="p">,</span> <span class="n">t_list</span><span class="p">,</span> <span class="n">Zxx_list</span> <span class="o">=</span>  <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ds</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ds_list</span><span class="p">):</span>
    <span class="n">f</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Zxx</span> <span class="o">=</span> <span class="n">plot_stft_histogram</span><span class="p">(</span><span class="n">ds_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">shot_ids</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">f_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">t_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">Zxx_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Zxx</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/e90e279a3cc4cc0d7fad806434ba032342e7892b60cf358ea5bb5a45fbf3bade.png" src="../../_images/e90e279a3cc4cc0d7fad806434ba032342e7892b60cf358ea5bb5a45fbf3bade.png" />
<img alt="../../_images/1e8e995f70704eddd9b00c006dace17736876b6802084bede341531ba4ea8097.png" src="../../_images/1e8e995f70704eddd9b00c006dace17736876b6802084bede341531ba4ea8097.png" />
<img alt="../../_images/1f906a19e864a23391bb6399072e82484297d67c5510ebee8132f2aea812af50.png" src="../../_images/1f906a19e864a23391bb6399072e82484297d67c5510ebee8132f2aea812af50.png" />
<img alt="../../_images/b2d04bae46aeeb9d41047021767121cd8c976e51282d1e1bccb13e1a1202be36.png" src="../../_images/b2d04bae46aeeb9d41047021767121cd8c976e51282d1e1bccb13e1a1202be36.png" />
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id1">
<h1>Ridge detection<a class="headerlink" href="#id1" title="Link to this heading">#</a></h1>
<section id="track-dominant-frequencies-over-time-of-zxx">
<h2>track dominant frequencies over time of Zxx<a class="headerlink" href="#track-dominant-frequencies-over-time-of-zxx" title="Link to this heading">#</a></h2>
<p>Find the most prominent modes (like chirping MHD modes) in the plasma.</p>
<ul class="simple">
<li><p>We compute the absolute amplitude of Zxx, then for each time slice (Zxx[:, t]), we find the index of the maximum amplitude, and map that back to a frequency using f. The x value in FFT shows a time slice.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_ridges</span></code> determines the number of max value of ridges to find. So <code class="docutils literal notranslate"><span class="pre">max_ridges=2</span></code>, picks the top 2 frequencies for each time bin by sorting Zxx amplitudes.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_stft_ridge</span><span class="p">(</span>
    <span class="n">t</span><span class="p">,</span>
    <span class="n">f</span><span class="p">,</span>
    <span class="n">Zxx</span><span class="p">,</span>
    <span class="n">shot_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">threshold</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span>
    <span class="n">max_ridges</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">fmax_kHz</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">smooth</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">smooth_window</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">return_ridges</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">min_bin_distance</span><span class="o">=</span><span class="mi">2</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extract and plot top-N ridges in STFT with better control.</span>
<span class="sd">    Prevents overlap and handles low-power regions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fmax</span> <span class="o">=</span> <span class="n">fmax_kHz</span> <span class="o">*</span> <span class="mi">1000</span>
    <span class="n">valid_freq_idx</span> <span class="o">=</span> <span class="n">f</span> <span class="o">&lt;=</span> <span class="n">fmax</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="n">valid_freq_idx</span><span class="p">]</span>
    <span class="n">Zxx</span> <span class="o">=</span> <span class="n">Zxx</span><span class="p">[</span><span class="n">valid_freq_idx</span><span class="p">,</span> <span class="p">:]</span>

    <span class="n">magnitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Zxx</span><span class="p">)</span>
    <span class="n">time_bins</span> <span class="o">=</span> <span class="n">magnitude</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">freq_bins</span> <span class="o">=</span> <span class="n">magnitude</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Set low amplitudes to zero</span>
    <span class="n">magnitude</span><span class="p">[</span><span class="n">magnitude</span> <span class="o">&lt;</span> <span class="n">threshold</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">ridge_list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">used_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">magnitude</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_ridges</span><span class="p">):</span>
        <span class="n">ridge_freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">time_bins</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">t_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">time_bins</span><span class="p">):</span>
            <span class="c1"># Get amplitudes for this time bin</span>
            <span class="n">col</span> <span class="o">=</span> <span class="n">magnitude</span><span class="p">[:,</span> <span class="n">t_idx</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

            <span class="c1"># Mask already used indices (avoid overlapping ridges)</span>
            <span class="n">col</span><span class="p">[</span><span class="n">used_mask</span><span class="p">[:,</span> <span class="n">t_idx</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="n">threshold</span><span class="p">:</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
                <span class="n">ridge_freq</span><span class="p">[</span><span class="n">t_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="mi">1000</span>  <span class="c1"># to kHz</span>

                <span class="c1"># Mark this bin and neighboring bins as used</span>
                <span class="n">i_start</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span> <span class="o">-</span> <span class="n">min_bin_distance</span><span class="p">)</span>
                <span class="n">i_end</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">freq_bins</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="n">min_bin_distance</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">used_mask</span><span class="p">[</span><span class="n">i_start</span><span class="p">:</span><span class="n">i_end</span><span class="p">,</span> <span class="n">t_idx</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">smooth</span><span class="p">:</span>
            <span class="n">filled</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan_to_num</span><span class="p">(</span><span class="n">ridge_freq</span><span class="p">,</span> <span class="n">nan</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
            <span class="n">smoothed</span> <span class="o">=</span> <span class="n">uniform_filter1d</span><span class="p">(</span><span class="n">filled</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">smooth_window</span><span class="p">)</span>
            <span class="n">ridge_freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">ridge_freq</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">smoothed</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">ridge_freq</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Ridge </span><span class="si">{</span><span class="n">r</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">ridge_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ridge_freq</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time [sec]&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Frequency [kHz]&quot;</span><span class="p">)</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;STFT Ridge Detection&quot;</span>
    <span class="k">if</span> <span class="n">shot_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">title</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; – Shot </span><span class="si">{</span><span class="n">shot_id</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">return_ridges</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ridge_list</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">plot_stft_ridge</span><span class="p">(</span>
    <span class="n">t_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
    <span class="n">f_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
    <span class="n">Zxx_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
    <span class="n">shot_id</span><span class="o">=</span><span class="n">shot_ids</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
    <span class="n">threshold</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span>
    <span class="n">max_ridges</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">fmax_kHz</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">smooth</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ds_list</span><span class="p">))]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[None, None, None, None]
</pre></div>
</div>
<img alt="../../_images/b77ae9c7e68f1d5a2885bb0469c6b5b3990c369cbd2fe1b7f26c77523f7047a9.png" src="../../_images/b77ae9c7e68f1d5a2885bb0469c6b5b3990c369cbd2fe1b7f26c77523f7047a9.png" />
<img alt="../../_images/0487ef9fb88df0244b2be89d786231a0d2fb80f5c5606d736d2d31528e085db3.png" src="../../_images/0487ef9fb88df0244b2be89d786231a0d2fb80f5c5606d736d2d31528e085db3.png" />
<img alt="../../_images/5c771d5c7c525d9b01e1f063a4a7e8b9d498f87ecefe3ef38c57d789d464eff2.png" src="../../_images/5c771d5c7c525d9b01e1f063a4a7e8b9d498f87ecefe3ef38c57d789d464eff2.png" />
<img alt="../../_images/86eaa809360a079bcb4c1c9365a8371b3504f17067f956f527510c91abdf737a.png" src="../../_images/86eaa809360a079bcb4c1c9365a8371b3504f17067f956f527510c91abdf737a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">plot_stft_ridge</span><span class="p">(</span>
    <span class="n">t_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
    <span class="n">f_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
    <span class="n">Zxx_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
    <span class="n">shot_id</span><span class="o">=</span><span class="n">shot_ids</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
    <span class="n">threshold</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span>
    <span class="n">max_ridges</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">fmax_kHz</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">smooth</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ds_list</span><span class="p">))]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[None, None, None, None]
</pre></div>
</div>
<img alt="../../_images/261a6dd872b58312a0b6a25f9b53c51cc94f397f27705fc4e1144f6dc81e0b38.png" src="../../_images/261a6dd872b58312a0b6a25f9b53c51cc94f397f27705fc4e1144f6dc81e0b38.png" />
<img alt="../../_images/9a9ad1cf1ab741061667f7cc558a89e2a650bf7cb2fed95bf272bab82e36642f.png" src="../../_images/9a9ad1cf1ab741061667f7cc558a89e2a650bf7cb2fed95bf272bab82e36642f.png" />
<img alt="../../_images/e62e63c3bc2ef2969d9c30537a2254b89f96bab8bfd8bbac9952e709991b162b.png" src="../../_images/e62e63c3bc2ef2969d9c30537a2254b89f96bab8bfd8bbac9952e709991b162b.png" />
<img alt="../../_images/69822d5928f49e7c53e082f3439fcb408a51c689d56cb71eac8da20c28dd4a94.png" src="../../_images/69822d5928f49e7c53e082f3439fcb408a51c689d56cb71eac8da20c28dd4a94.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_spectrogram_with_ridges</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">Zxx</span><span class="p">,</span> <span class="n">ridge_freqs_kHz</span><span class="p">,</span> <span class="n">shot_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span> <span class="n">fmax_kHz</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot the STFT spectrogram with overlayed ridge tracks.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.colors</span><span class="w"> </span><span class="kn">import</span> <span class="n">LogNorm</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="n">f_kHz</span> <span class="o">=</span> <span class="n">f</span> <span class="o">/</span> <span class="mi">1000</span>

    <span class="n">cax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">f_kHz</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Zxx</span><span class="p">),</span> <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span>
                        <span class="n">norm</span><span class="o">=</span><span class="n">LogNorm</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">)</span>

    <span class="c1"># Custom color cycle</span>
    <span class="n">ridge_colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;magenta&#39;</span><span class="p">,</span> <span class="s1">&#39;lime&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ridge</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ridge_freqs_kHz</span><span class="p">):</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">ridge_colors</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">ridge_colors</span><span class="p">)]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">ridge</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Ridge </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fmax_kHz</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time [sec]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency [kHz]&#39;</span><span class="p">)</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;STFT Spectrogram with Ridge Overlay&quot;</span>
    <span class="k">if</span> <span class="n">shot_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">title</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; – Shot </span><span class="si">{</span><span class="n">shot_id</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cax</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Amplitude&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ridges</span> <span class="o">=</span> <span class="n">plot_stft_ridge</span><span class="p">(</span>
    <span class="n">t_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">f_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">Zxx_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">shot_id</span><span class="o">=</span><span class="n">shot_ids</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">threshold</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span>
    <span class="n">max_ridges</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">fmax_kHz</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">smooth</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">return_ridges</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="c1"># Then overlay them:</span>
<span class="n">plot_spectrogram_with_ridges</span><span class="p">(</span><span class="n">t_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">f_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Zxx_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ridge_freqs_kHz</span><span class="o">=</span><span class="n">ridges</span><span class="p">,</span> <span class="n">shot_id</span><span class="o">=</span><span class="n">shot_ids</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_1087196/2863097040.py:32: UserWarning: Creating legend with loc=&quot;best&quot; can be slow with large amounts of data.
  plt.tight_layout()
</pre></div>
</div>
<img alt="../../_images/261a6dd872b58312a0b6a25f9b53c51cc94f397f27705fc4e1144f6dc81e0b38.png" src="../../_images/261a6dd872b58312a0b6a25f9b53c51cc94f397f27705fc4e1144f6dc81e0b38.png" />
<img alt="../../_images/788339521bd66dfc75e40781e6a79281f0a6cfe05364955a4a2aa4d051d3a0b6.png" src="../../_images/788339521bd66dfc75e40781e6a79281f0a6cfe05364955a4a2aa4d051d3a0b6.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ridges</span> <span class="o">=</span> <span class="n">plot_stft_ridge</span><span class="p">(</span>
    <span class="n">t_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">f_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">Zxx_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">shot_id</span><span class="o">=</span><span class="n">shot_ids</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">threshold</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span>
    <span class="n">max_ridges</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">fmax_kHz</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">smooth</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">return_ridges</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="c1"># Then overlay them:</span>
<span class="n">plot_spectrogram_with_ridges</span><span class="p">(</span><span class="n">t_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">f_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Zxx_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ridge_freqs_kHz</span><span class="o">=</span><span class="n">ridges</span><span class="p">,</span> <span class="n">shot_id</span><span class="o">=</span><span class="n">shot_ids</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/d3f2158c86f4ebd55613ffa1717932b2e0fd83c4be6729e7c0e1d5c99c7417ab.png" src="../../_images/d3f2158c86f4ebd55613ffa1717932b2e0fd83c4be6729e7c0e1d5c99c7417ab.png" />
<img alt="../../_images/64c2ee46c2564c137e896a9f0a62526450bee61faae26b9c27a4e2124ebdb8b5.png" src="../../_images/64c2ee46c2564c137e896a9f0a62526450bee61faae26b9c27a4e2124ebdb8b5.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Theory/3. MHD modes"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="4.%20Thresholding.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Thresholding</p>
      </div>
    </a>
    <a class="right-next"
       href="6.%20Contour%20detection.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Contour Detection from STFT</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> 
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Ridge detection</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#short-time-fourier-transform-stft">Short-Time Fourier Transform (STFT)</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Ridge detection</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#track-dominant-frequencies-over-time-of-zxx">track dominant frequencies over time of Zxx</a></li>
</ul>
</li>
</ul>

  </nav></div>

  <div class="sidebar-secondary-item">

  
  <div class="tocsection editthispage">
    <a href="https://github.com/praksharma/Knowledge-Base/edit/main/docs/Theory/3. MHD modes/5. Ridge detection.ipynb">
      <i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
  </div>
</div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/Theory/3. MHD modes/5. Ridge detection.ipynb"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025, By Prakhar Sharma.
      <br/>
    
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__center">
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.4.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>